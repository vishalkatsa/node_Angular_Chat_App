<div class="flex h-screen overflow-hidden bg-[#00a783] p-4">
    <!-- Sidebar -->
    <div class="w-full lg:w-1/4 border-r border-gray-300 h-screen bg-white overflow-y-auto">
        <div class="flex items-center gap-1 py-6 px-6  bg-gray-100 border-b mb-5">
            <div class="font-medium text-xl">Chats</div>
            <div class="border border-blue-500 rounded-full p-[2px]">
                <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" class="w-16 h-16 rounded-full"
                    alt="Profile Image">
            </div>
            <div class="ml-8">
                <h3 class="text-lg text-gray-800 font-semibold uppercase">{{ this?.UserLoginData?.name }}</h3>
                <p class="text-base font-light text-gray-600">{{this?.UserLoginData?.email}}</p>
            </div>
        </div>
        <div class=" ">
            <ng-container *ngFor="let conversation of Conversation">
                <div (click)="fetchMessage(conversation)"
                    class="flex justify-stretch pl-5 items-center  py-2 cursor-pointer hover:bg-gray-200 transition duration-300 ease-in-out">
                    <div class="border border-blue-500 rounded-full p-[2px]">
                        <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" class="w-16 h-16 rounded-full"
                            alt="Profile Image" />
                    </div>
                    <div class="ml-8">
                        <h3 class="text-xl text-gray-800 font-semibold">{{ conversation?.user?.fullname }}</h3>
                        <p class="text-base font-light text-gray-600">{{ conversation?.user?.email }}</p>
                    </div>
                </div>
            </ng-container>
        </div>
    </div>
    <!-- Main Content -->
    <div class="hidden lg:block w-1/2 h-screen relative bg-white">
        <div class='w-full bg-blue-500 h-20 flex items-center px-14 py-2'>
            <div class='cursor-pointer'>
                <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" class="rounded-full w-16 h-16" />
            </div>
            <div class='ml-6 mr-auto'>
                <h3 class='text-lg text-white font-semibold'>{{myconversationUser?.fullname}}</h3>
                <p class='text-sm font-light text-gray-200'>{{myconversationUser.email}} <span>{{Typing !== '' ? 'Typing...' : ''}}</span></p>
            </div>
            <div class='cursor-pointer text-white'>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-phone-outgoing" width="24"
                    height="24" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path
                        d="M5 4h4l2 5l-2.5 1.5a11 11 0 0 0 5 5l1.5 -2.5l5 2v4a2 2 0 0 1 -2 2a16 16 0 0 1 -15 -15a2 2 0 0 1 2 -2" />
                    <line x1="15" y1="9" x2="20" y2="4" />
                    <polyline points="16 4 20 4 20 8" />
                </svg>
            </div>
        </div>
        <div class='h-[75%] w-full overflow-y-auto shadow-sm bg-white'>
            <div class='px-10 py-14 overflow-y-auto'>
                @if (Messages.length !== 0) {
                @for (item of Messages; track $index) {
                @if (item?.user?._id === UserLoginData?._id) {
                <div class="max-w-[40%] bg-blue-600 rounded-b-xl rounded-tr-xl p-4 mb-6 ml-auto text-white">
                    {{ item?.message }}
                </div>
                }@else {
                <div class="max-w-[40%] bg-gray-200 rounded-b-xl rounded-tr-xl p-4 mb-6">
                    {{ item?.message }}
                </div>
                }
                }
                }@else {
                <h1 class="text-xl font-semibold text-gray-600">No Messages</h1>
                }
            </div>
            <div class="p-1 flex justify-center gap-5 py-5 absolute bottom-4 border-t-2 w-full bg-gray-200">
                <input [(ngModel)]="message" (input)="TypingHandler()" placeholder="Type a Message"
                    class="px-6 py-2 border border-black rounded-md w-full " />
                <button (click)="SendMessage()"
                    class="px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition duration-300 ease-in-out">Send
                    Message</button>
            </div>
        </div>
    </div>
    <!-- People Sidebar -->
    <div class="hidden lg:block w-full lg:w-1/4 border-l border-gray-300 h-screen bg-white">
        <div class="flex justify-between items-center py-11 px-8  border-b font-medium text-xl bg-gray-100">Contacts
            Peoples</div>
        <ng-container *ngFor="let user of users">
            @if (user?.user?.receiverId !== UserLoginData?._id) {

            <ng-container *ngIf="!conversationExists(user.user.receiverId)">
                <div (click)="newConversation(user?.user?.receiverId); fetchMessage2(user?.user?.receiverId)"
                    class="flex justify-center items-center py-2  cursor-pointer border-b hover:bg-gray-200 transition duration-300 ease-in-out">
                    <div class="border border-blue-500 rounded-full p-[2px]">
                        <img src="https://cdn-icons-png.flaticon.com/512/149/149071.png" class="w-16 h-16 rounded-full"
                            alt="Profile Image" />
                    </div>
                    <div class="ml-8">
                        <h3 class="text-xl text-gray-800 font-semibold">{{ user?.user?.fullname }}</h3>
                        <p class="text-base font-light text-gray-600">{{ user?.user?.email }}</p>
                    </div>
                </div>
            </ng-container>

            }
        </ng-container>
    </div>
</div>